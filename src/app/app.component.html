<div class="container mt-4">
  <h2>Food Sales Data</h2>

  <div class="d-flex mb-3">
    <input
      type="text"
      class="form-control"
      placeholder="Search..."
      [(ngModel)]="search"
      (input)="onSearchChange()"
      style="max-width: 300px"
    />
    <button class="btn btn-primary ms-2" (click)="openModal(null)">Add New</button>
  </div>

  <table class="table table-striped table-bordered table-hover table-responsive">
    <thead>
      <tr>
        <th *ngFor="let key of getKeys()" (click)="onSort(key)" style="cursor:pointer">
          {{ key }}
          <span *ngIf="sortField === key">{{ sortAsc ? '▲' : '▼' }}</span>
        </th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let record of filteredSales">
        <td *ngFor="let key of getKeys()">{{ record[key] }}</td>
        <td>
          <button class="btn btn-warning btn-sm me-1" (click)="openModal(record)">Edit</button>
          <button class="btn btn-danger btn-sm" (click)="deleteRecord(record.id)">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Modal -->
<div
  class="modal fade"
  tabindex="-1"
  [ngClass]="{ show: showModal }"
  [ngStyle]="{ display: showModal ? 'block' : 'none', backgroundColor: 'rgba(0,0,0,0.5)' }"
  role="dialog"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">{{ editRecord ? 'Edit Record' : 'Add New Record' }}</h5>
        <button type="button" class="btn-close" aria-label="Close" (click)="closeModal()"></button>
      </div>
      <div class="modal-body">
        <form>
          <div *ngFor="let key of getKeys()" class="mb-3">
            <label [for]="key" class="form-label">{{ key }}</label>
            <input
              [id]="key"
              class="form-control"
              type="text"
              [(ngModel)]="newRecord[key]"
              name="{{ key }}"
              [readonly]="key === 'id' && editRecord !== null"
            />
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeModal()">Cancel</button>
        <button class="btn btn-primary" (click)="saveRecord()">Save</button>
      </div>
    </div>
  </div>
</div>
